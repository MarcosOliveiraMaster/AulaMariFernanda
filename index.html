<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Aula Maria Fernanda — Aluna Máster Educação | Funções</title>
  <style>
    :root{
      --azul-1:#0b3d91; /* azul profundo para header */
      --azul-2:#1565c0; /* azul médio para destaques */
      --azul-3:#e3f2fd; /* azul muito claro para fundos */
      --azul-4:#1976d2; /* botões */
      --branco:#ffffff;
      --cinza:#f5f7fb;
      --texto:#0f172a;
      --ok:#1b5e20;
      --erro:#c62828;
      --sombra: 0 8px 20px rgba(11,61,145,0.12);
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--cinza);color:var(--texto);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;line-height:1.5}
    a{color:var(--azul-2);text-decoration:none}
    header{
      position:sticky;top:0;z-index:10;
      background:linear-gradient(90deg,var(--azul-1),var(--azul-2));
      color:var(--branco);
      box-shadow:var(--sombra);
    }
    .nav{max-width:1100px;margin:0 auto;display:flex;align-items:center;gap:16px;padding:12px 20px;flex-wrap:wrap}
    .brand{font-weight:800;letter-spacing:.3px}
    .brand small{opacity:.9;font-weight:600}
    .nav a{color:var(--branco);opacity:.9;padding:8px 10px;border-radius:10px}
    .nav a:hover{background:rgba(255,255,255,.15);opacity:1}

    .banner{background:linear-gradient(180deg,var(--azul-2),#2e8be6 60%,var(--azul-3));color:var(--branco);padding:36px 16px 28px}
    .banner-inner{max-width:1100px;margin:0 auto;display:grid;grid-template-columns:1.1fr .9fr;gap:22px;align-items:center}
    .badge{display:inline-block;background:rgba(255,255,255,.2);border:1px solid rgba(255,255,255,.45);padding:6px 10px;border-radius:999px;font-size:.9rem}
    h1{margin:10px 0 6px;font-size:2.2rem}
    .subtitle{opacity:.95;margin-top:4px}
    .card{background:var(--branco);border-radius:18px;box-shadow:var(--sombra);padding:18px}

    main{max-width:1100px;margin:18px auto;padding:0 16px;display:grid;gap:18px}
    section h2{margin:0 0 8px}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
    @media (max-width:920px){.banner-inner{grid-template-columns:1fr}.grid-2,.grid-3{grid-template-columns:1fr}}

    .pill{display:inline-flex;align-items:center;gap:8px;background:var(--azul-3);color:#0b2a5c;border:1px solid #cfe8ff;border-radius:999px;padding:6px 10px;font-weight:600}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace}

    .btn{background:var(--azul-4);color:var(--branco);border:none;border-radius:12px;padding:10px 14px;font-weight:700;cursor:pointer}
    .btn.secondary{background:#e8f1ff;color:#103b87;border:1px solid #bcd8ff}
    .btn.ghost{background:transparent;color:var(--azul-4);border:1px dashed var(--azul-4)}
    .btn:disabled{opacity:.5;cursor:not-allowed}

    .notice{padding:10px 12px;border-left:4px solid var(--azul-2);background:var(--azul-3);border-radius:10px}
    .good{color:var(--ok);font-weight:700}
    .bad{color:var(--erro);font-weight:700}

    .q{border:1px solid #e6eefb;border-radius:16px;padding:14px;margin:10px 0;background:#fcfdff}
    .q h4{margin:0 0 10px}
    .q footer{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .feedback{font-weight:700}
    .answer{display:none;margin-left:8px}

    .tabela{width:100%;border-collapse:collapse}
    .tabela th,.tabela td{border:1px solid #d7e6ff;padding:8px;text-align:center}
    .tabela th{background:#eaf3ff}

    /* Canvas/grade */
    #grafico-wrap{display:grid;grid-template-columns:1.2fr .8fr;gap:14px}
    #canvas{width:100%;height:420px;background:#ffffff;border-radius:16px;border:1px solid #d1e3ff}
    @media(max-width:920px){#grafico-wrap{grid-template-columns:1fr}}

    .footer{margin:24px auto 40px;max-width:1100px;padding:12px 16px;color:#375e9f}
  </style>
</head>
<body>
  <header>
    <nav class="nav">
      <div class="brand">Aula Maria Fernanda · <small>Aluna Máster Educação</small></div>
      <div style="flex:1"></div>
      <a href="#intro">Introdução</a>
      <a href="#oque">O que é função</a>
      <a href="#nao-e">O que não é</a>
      <a href="#exemplos">Exemplos</a>
      <a href="#construir">Construir função</a>
      <a href="#grafico">Dinâmica de gráficos</a>
      <a href="#exercicios">Exercícios</a>
    </nav>
  </header>

  <div class="banner">
    <div class="banner-inner">
      <div>
        <span class="badge">Trilha: Matemática · 9º ano (Extensão Fundamental)</span>
        <h1>Funções — guia objetivo, direto e visual</h1>
        <p class="subtitle">Explicações curtas, cores em tons de <b>azul</b> e <b>branco</b>, exercícios interativos com gabarito e uma atividade de gráfico para fixar.</p>
        <div style="display:flex;gap:10px;margin-top:10px;flex-wrap:wrap">
          <button class="btn" onclick="rolar('#exercicios')">Ir para os exercícios</button>
          <button class="btn secondary" onclick="rolar('#grafico')">Ir para a dinâmica de gráficos</button>
        </div>
      </div>
      <div class="card">
        <h3 style="margin-top:0; color:black">Estrutura da aula</h3>
        <ol style="margin:0 0 8px 18px; color:black">
          <li>O que é função · máquina de entradas e saídas</li>
          <li>O que não é função · teste da linha vertical</li>
          <li>Exemplos e contraexemplos do dia a dia</li>
          <li>Como construir uma função (tabela → gráfico)</li>
          <li>Dinâmica de gráficos (atividade prática)</li>
          <li>Exercícios interativos com gabarito imediato</li>
        </ol>
        <div class="notice" style="color:black">Dica TDAH: alternar <b>microblocos</b> de teoria e prática + feedback imediato.</div>
      </div>
    </div>
  </div>

  <main>
    <section id="intro" class="card">
      <h2>Introdução (produção)</h2>
      <p><b>Função</b> é uma <b>regra</b> que, para cada <span class="pill">entrada <span class="mono">x</span></span>, produz uma única <span class="pill">saída <span class="mono">y</span></span>. Pense numa máquina: entra um número, sai exatamente um resultado.</p>
      <ul>
        <li><b>Domínio</b>: valores possíveis de <span class="mono">x</span>.</li>
        <li><b>Imagem</b>: resultados possíveis de <span class="mono">y</span>.</li>
        <li><b>Regra/Lei</b>: como transformar <span class="mono">x</span> em <span class="mono">y</span> (ex.: <span class="mono">y = 2x + 1</span>).</li>
      </ul>
    </section>

    <section id="oque" class="card">
      <h2>O que é função?</h2>
      <div class="grid-2">
        <div>
          <p><b>Definição curta:</b> relação que associa <b>cada</b> entrada a <b>uma única</b> saída.</p>
          <p><b>Critério visual:</b> em um gráfico, nenhuma linha vertical deve tocar a curva em dois pontos.</p>
          <div class="notice">Ex.: <span class="mono">y = x + 2</span>, <span class="mono">y = |x|</span>, preço = taxa fixa + valor por unidade.</div>
        </div>
        <div>
          <table class="tabela">
            <thead><tr><th>Entrada (x)</th><th>Saída (y)</th><th>Regra</th></tr></thead>
            <tbody>
              <tr><td>3</td><td>5</td><td><span class="mono">y = x + 2</span></td></tr>
              <tr><td>−1</td><td>1</td><td><span class="mono">y = |x|</span></td></tr>
              <tr><td>2</td><td>4</td><td><span class="mono">y = 2x</span></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <section id="nao-e" class="card">
      <h2>O que <u>não</u> é função?</h2>
      <ul>
        <li>Uma entrada com <b>duas saídas</b> (ex.: <span class="mono">x=4</span> gera <span class="mono">y=2</span> e <span class="mono">y=−2</span>).</li>
        <li>Gráfico que falha no <b>teste da linha vertical</b>.</li>
        <li>Tabelas com a mesma entrada aparecendo com saídas diferentes.</li>
      </ul>
      <div class="notice">Ex.: <span class="mono">x = y^2</span> (mesmo <span class="mono">x</span> pode ter <span class="mono">y</span> positivo e negativo).</div>
    </section>

    <section id="exemplos" class="card">
      <h2>Exemplos e contraexemplos</h2>
      <div class="grid-2">
        <div>
          <h3 style="margin-top:0">Exemplos de função</h3>
          <ol>
            <li><span class="mono">y = x + 2</span></li>
            <li>Preço final = preço base − desconto fixo</li>
            <li>Idade ↔ ano de nascimento (cada ano → uma idade)</li>
          </ol>
        </div>
        <div>
          <h3 style="margin-top:0">Exemplos de <u>não</u> função</h3>
          <ol>
            <li><span class="mono">x = y^2</span></li>
            <li>Nome → pessoa (um nome pode ter várias pessoas)</li>
            <li>Tamanho da pizza → sabor (muitas saídas possíveis)</li>
          </ol>
        </div>
      </div>
    </section>

    <section id="construir" class="card">
      <h2>Como construir uma função (tabela → gráfico)</h2>
      <ol>
        <li>Escolha uma regra: ex. <span class="mono">y = 2x + 1</span>.</li>
        <li>Monte uma tabela de valores para <span class="mono">x</span>.</li>
        <li>Calcule as saídas <span class="mono">y</span>.</li>
        <li>Marque os pontos e una: formou o gráfico.</li>
      </ol>
    </section>

    <section id="grafico" class="card">
      <h2>Dinâmica de gráficos (atividade prática)</h2>
      <div id="grafico-wrap">
        <canvas id="canvas" width="700" height="420" aria-label="Plano cartesiano interativo"></canvas>
        <div>
          <p>1) Escolha a função · 2) Preencha a tabela · 3) Plote e confira</p>
          <label>Função:
            <select id="funcSelect">
              <option value="linear">y = 2x + 1</option>
              <option value="absoluto">y = |x|</option>
              <option value="quadratica">y = x²</option>
            </select>
          </label>
          <table class="tabela" style="margin-top:10px">
            <thead><tr><th>x</th><th>y (digite)</th></tr></thead>
            <tbody id="tbodyVals"></tbody>
          </table>
          <div style="display:flex;gap:8px;margin-top:10px">
            <button class="btn" onclick="plotar()">Plotar</button>
            <button class="btn secondary" onclick="preencherGabarito()">Preencher gabarito</button>
            <button class="btn ghost" onclick="limparCanvas()">Limpar</button>
          </div>
          <p id="grafMsg" class="feedback"></p>
        </div>
      </div>
    </section>

    <section id="exercicios" class="card">
      <h2>Exercícios interativos (com gabarito)</h2>
      <p>São <b>25 questões</b>, organizadas em 5 blocos (5 de cada): <b>é função?</b>, <b>não é função?</b>, <b>cálculos</b>, <b>interpretação</b> e <b>conceitos</b>. Marque alternativas ou responda e clique em <b>Verificar</b>.</p>
      <div id="listaQuestoes"></div>
      <div style="display:flex;gap:10px;margin-top:10px">
        <button class="btn" onclick="verificarTudo()">Verificar tudo</button>
        <button class="btn secondary" onclick="mostrarGabaritos()">Mostrar gabaritos</button>
        <button class="btn ghost" onclick="resetQuestoes()">Limpar respostas</button>
      </div>
    </section>
  </main>

  <div class="footer">
    © Aula Maria Fernanda — Aluna Máster Educação · Cores: tons de azul e branco · Feedback imediato para foco e motivação.
  </div>

  <script>
    // ======= Utils =======
    function rolar(sel){document.querySelector(sel).scrollIntoView({behavior:'smooth'})}
    const $ = s => document.querySelector(s);

    // ======= Dinâmica de gráficos =======
    const xsBase = [-2,-1,0,1,2];
    function regraAtual(x){
      const v = $('#funcSelect').value;
      if(v==='linear') return 2*x+1;
      if(v==='absoluto') return Math.abs(x);
      if(v==='quadratica') return x*x;
      return x;
    }
    function montarTabela(){
      const tb = $('#tbodyVals');
      tb.innerHTML = '';
      xsBase.forEach((x,i)=>{
        const tr = document.createElement('tr');
        const td1 = document.createElement('td'); td1.textContent = x;
        const td2 = document.createElement('td');
        const inp = document.createElement('input');
        inp.type='number'; inp.step='any'; inp.style.width='100%'; inp.dataset.x = x;
        td2.appendChild(inp);
        tr.appendChild(td1); tr.appendChild(td2);
        tb.appendChild(tr);
      })
      $('#grafMsg').textContent='';
      desenharGrade();
    }
    $('#funcSelect').addEventListener('change', montarTabela);

    // Canvas/grid
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const W = canvas.width, H = canvas.height;
    const origem = {x: W/2, y: H/2};
    const escala = 50; // px por unidade

    function desenharGrade(){
      ctx.clearRect(0,0,W,H);
      // fundo
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0,0,W,H);
      // linhas leves
      ctx.strokeStyle = '#e6eefb';
      ctx.lineWidth = 1;
      for(let x=0; x<=W; x+=escala){
        ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,H); ctx.stroke();
      }
      for(let y=0; y<=H; y+=escala){
        ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(W,y); ctx.stroke();
      }
      // eixos
      ctx.strokeStyle = '#1565c0';
      ctx.lineWidth = 2;
      // eixo x
      ctx.beginPath(); ctx.moveTo(0,origem.y); ctx.lineTo(W,origem.y); ctx.stroke();
      // eixo y
      ctx.beginPath(); ctx.moveTo(origem.x,0); ctx.lineTo(origem.x,H); ctx.stroke();
      // marcas
      ctx.fillStyle = '#0b3d91';
      ctx.font = '12px system-ui';
      for(let i=-Math.floor(W/(2*escala)); i<=Math.floor(W/(2*escala)); i++){
        const x = origem.x + i*escala;
        ctx.fillRect(x,origem.y-3,1,6);
        if(i!==0) ctx.fillText(i.toString(), x-3, origem.y+14);
      }
      for(let j=-Math.floor(H/(2*escala)); j<=Math.floor(H/(2*escala)); j++){
        const y = origem.y - j*escala;
        ctx.fillRect(origem.x-3,y,6,1);
        if(j!==0) ctx.fillText(j.toString(), origem.x+6, y+4);
      }
    }

    function toCanvasPoint(x,y){
      return {x: origem.x + x*escala, y: origem.y - y*escala};
    }

    function plotar(){
      desenharGrade();
      const inputs = Array.from(document.querySelectorAll('#tbodyVals input'));
      const pontos = [];
      let acertos = 0;
      inputs.forEach(inp=>{
        const x = Number(inp.dataset.x);
        const y = Number(inp.value);
        const yc = regraAtual(x);
        const correto = Math.abs(y - yc) < 1e-9;
        if(!isFinite(y)) return;
        pontos.push({x,y,ok:correto});
        if(correto) acertos++;
      })
      // plotar pontos
      pontos.forEach(p=>{
        const c = toCanvasPoint(p.x,p.y);
        ctx.beginPath();
        ctx.arc(c.x,c.y,5,0,Math.PI*2);
        ctx.fillStyle = p.ok? '#1b5e20' : '#c62828';
        ctx.fill();
        ctx.strokeStyle = '#0b3d91';
        ctx.stroke();
      })
      // se tudo certo, desenhar curva/segmentos aproximados
      if(acertos===xsBase.length){
        ctx.strokeStyle = '#1976d2';
        ctx.lineWidth = 2.5;
        ctx.beginPath();
        const v = $('#funcSelect').value;
        const xs = [];
        for(let t=-2; t<=2; t+=0.05){ xs.push(t); }
        xs.forEach((x,i)=>{
          let y = regraAtual(x);
          const p = toCanvasPoint(x,y);
          if(i===0) ctx.moveTo(p.x,p.y); else ctx.lineTo(p.x,p.y);
        })
        ctx.stroke();
        $('#grafMsg').innerHTML = '<span class="good">Parabéns!</span> Pontos corretos formaram o gráfico.';
      } else {
        $('#grafMsg').innerHTML = '<span class="bad">Confira seus cálculos.</span> Pontos em verde estão corretos.';
      }
    }

    function preencherGabarito(){
      document.querySelectorAll('#tbodyVals input').forEach(inp=>{
        const x = Number(inp.dataset.x);
        inp.value = regraAtual(x);
      });
    }

    function limparCanvas(){ desenharGrade(); $('#grafMsg').textContent=''; document.querySelectorAll('#tbodyVals input').forEach(i=>i.value=''); }

    // ======= Banco de questões =======
    // Tipos: mc (múltipla escolha), ab (aberta numérica ou texto curto)
    const Questoes = [
      // Bloco 1: É função? (5)
      {cat:'É função?', tipo:'mc', enunciado:'Qual relação é uma função de x para y?', op:['x → y com y = 2x + 1','x → y com x = y²','Para x=3, y pode ser 2 ou -2','Cada nome mapeia para várias pessoas'], resp:0, exp:'Função precisa ter saída única para cada entrada. y=2x+1 atende.'},
      {cat:'É função?', tipo:'mc', enunciado:'No gráfico, a regra passa no teste da linha vertical. Isso indica que:', op:['É função','Não é função','É proporcionalidade inversa','É uma relação simétrica'], resp:0, exp:'Se nenhuma vertical corta em dois pontos, é função.'},
      {cat:'É função?', tipo:'mc', enunciado:'Tabela: (1→2), (2→4), (2→5), (3→6). Isso é função?', op:['Sim','Não'], resp:1, exp:'A mesma entrada 2 tem duas saídas (4 e 5).'},
      {cat:'É função?', tipo:'mc', enunciado:'Relação: idade ↔ ano de nascimento (fixo). Isso é função?', op:['Sim','Não'], resp:0, exp:'Cada ano de nascimento determina uma única idade em um ano específico.'},
      {cat:'É função?', tipo:'mc', enunciado:'Relação: y = |x|. É função?', op:['Sim','Não'], resp:0, exp:'Para cada x há exatamente um y (valor absoluto).'},

      // Bloco 2: Não é função? (5)
      {cat:'Não é função?', tipo:'mc', enunciado:'Qual NÃO representa função?', op:['x ↦ x²','x ↦ √x (com x ≥ 0)','x ↦ ±√x','x ↦ 2x − 3'], resp:2, exp:'±√x dá duas saídas para o mesmo x.'},
      {cat:'Não é função?', tipo:'mc', enunciado:'Em um gráfico de círculo (x² + y² = 4), isso é função?', op:['Sim','Não'], resp:1, exp:'Círculo falha no teste da linha vertical.'},
      {cat:'Não é função?', tipo:'mc', enunciado:'Tabelas que repetem a mesma entrada com saídas diferentes:', op:['São funções','Não são funções'], resp:1, exp:'Violam a unicidade da saída.'},
      {cat:'Não é função?', tipo:'mc', enunciado:'x = y² representa y como função de x?', op:['Sim','Não'], resp:1, exp:'Para um mesmo x>0, y pode ser +√x e -√x.'},
      {cat:'Não é função?', tipo:'mc', enunciado:'Relação: tamanho da pizza → sabor possível. É função?', op:['Sim','Não'], resp:1, exp:'Um tamanho pode ter vários sabores.'},

      // Bloco 3: Cálculos (5)
      {cat:'Cálculos', tipo:'ab', enunciado:'Se f(x)=2x+1, calcule f(3).', ans:'7', exp:'f(3)=2·3+1=7.'},
      {cat:'Cálculos', tipo:'ab', enunciado:'Se g(x)=x², calcule g(-2).', ans:'4', exp:'(-2)²=4.'},
      {cat:'Cálculos', tipo:'ab', enunciado:'Se h(x)=|x|, calcule h(-5).', ans:'5', exp:'Valor absoluto de -5 é 5.'},
      {cat:'Cálculos', tipo:'ab', enunciado:'Se p(x)=3x-4, ache x tal que p(x)=8.', ans:'4', exp:'3x-4=8 ⇒ 3x=12 ⇒ x=4.'},
      {cat:'Cálculos', tipo:'ab', enunciado:'f(x)=x²+2x. Calcule f(1).', ans:'3', exp:'1²+2·1=3.'},

      // Bloco 4: Interpretação (5)
      {cat:'Interpretação', tipo:'mc', enunciado:'Uma loja tem lucro L(x)=50+10x, onde x é o nº de produtos. O que significa 50?', op:['Lucro por produto','Lucro fixo','Preço por produto','Desconto'], resp:1, exp:'Termo independente é a parte fixa.'},
      {cat:'Interpretação', tipo:'ab', enunciado:'Passe de ônibus R(d)=8d representa gasto em d dias (2 ônibus/dia, R$4 cada). Quanto gasta em 5 dias?', ans:'40', exp:'8·5=40.'},
      {cat:'Interpretação', tipo:'mc', enunciado:'Corrida: C(k)=5+2k (R$). O que é 2?', op:['Tarifa inicial','Preço por km','Desconto','Velocidade'], resp:1, exp:'Coeficiente de k é preço por km.'},
      {cat:'Interpretação', tipo:'ab', enunciado:'Plano de celular: P(m)=29+10m. Quanto em 3 meses?', ans:'59', exp:'29+10·3=59.'},
      {cat:'Interpretação', tipo:'mc', enunciado:'Se V(t)=100−5t (estoque), qual interpretação de −5?', op:['Aumenta 5 por t','Diminui 5 por t','Valor inicial','Desconhecido'], resp:1, exp:'Coeficiente negativo: decresce 5 por unidade de t.'},

      // Bloco 5: Conceitos (5) — domínio, imagem, propriedades simples
      {cat:'Conceitos', tipo:'mc', enunciado:'Domínio de f(x)=√x é:', op:['Todos os reais','x ≥ 0','x > 0','x ≤ 0'], resp:1, exp:'Raiz quadrada real definida para x≥0.'},
      {cat:'Conceitos', tipo:'mc', enunciado:'Imagem de f(x)=|x| é:', op:['Reais','x ≥ 0','x ≤ 0','Inteiros'], resp:1, exp:'Valor absoluto nunca é negativo.'},
      {cat:'Conceitos', tipo:'mc', enunciado:'f(x)=2x é função linear. Seu gráfico é:', op:['Reta','Parábola','Círculo','Hipérbole'], resp:0, exp:'Função de 1º grau é reta.'},
      {cat:'Conceitos', tipo:'ab', enunciado:'Complete: no “teste da ____ vertical”, se uma linha cortar o gráfico em dois pontos, não é função.', ans:'linha', exp:'É o teste da linha vertical.'},
      {cat:'Conceitos', tipo:'ab', enunciado:'Se f(x)=x², qual é f(0)?', ans:'0', exp:'0²=0.'}
    ];

    function criarQuestaoHTML(q, idx){
      const div = document.createElement('div');
      div.className = 'q';
      const titulo = `<div class="pill">${q.cat}</div>`;
      let corpo = `<h4>${idx+1}. ${q.enunciado}</h4>`;
      if(q.tipo==='mc'){
        const ops = q.op.map((t,i)=>{
          const id = `q${idx}_op${i}`;
          return `<label style="display:block;margin:6px 0"><input type="radio" name="q${idx}" value="${i}"> ${t}</label>`
        }).join('');
        corpo += ops;
      } else if(q.tipo==='ab'){
        corpo += `<input type="text" id="q${idx}_ab" placeholder="Digite sua resposta" style="width:100%;padding:8px;border:1px solid #cfe1ff;border-radius:10px">`;
      }
      const footer = `<footer>
        <button class="btn" onclick="verificar(${idx})">Verificar</button>
        <button class="btn secondary" onclick="mostrarGabarito(${idx})">Mostrar gabarito</button>
        <span id="fb${idx}" class="feedback"></span>
        <span id="ans${idx}" class="answer"></span>
      </footer>`;
      div.innerHTML = titulo + corpo + footer;
      return div;
    }

    function montarQuestoes(){
      const wrap = $('#listaQuestoes');
      wrap.innerHTML = '';
      Questoes.forEach((q,i)=> wrap.appendChild(criarQuestaoHTML(q,i)) );
    }

    function normalizarTexto(s){
      return (s||'').toString().trim().toLowerCase()
        .normalize('NFD').replace(/[\u0300-\u036f]/g,'');
    }

    function verificar(i){
      const q = Questoes[i];
      const fb = $(`#fb${i}`); const ans = $(`#ans${i}`);
      let ok = false;
      if(q.tipo==='mc'){
        const marcado = document.querySelector(`input[name="q${i}"]:checked`);
        if(!marcado){ fb.innerHTML = '<span class="bad">Selecione uma alternativa.</span>'; return; }
        ok = Number(marcado.value) === q.resp;
      } else {
        const val = normalizarTexto($(`#q${i}_ab`).value);
        ok = (val === normalizarTexto(q.ans));
      }
      if(ok){ fb.innerHTML = '<span class="good">✔ Correto!</span>'; ans.style.display='none'; }
      else { fb.innerHTML = '<span class="bad">✘ Resposta incorreta.</span>'; ans.style.display='inline'; ans.textContent = `Gabarito: ${q.tipo==='mc'? q.op[q.resp] : q.ans}`; }
    }

    function mostrarGabarito(i){
      const q = Questoes[i];
      const ans = $(`#ans${i}`);
      ans.style.display='inline';
      ans.textContent = `Gabarito: ${q.tipo==='mc'? q.op[q.resp] : q.ans}`;
    }

    function verificarTudo(){
      for(let i=0;i<Questoes.length;i++){ verificar(i); }
    }
    function mostrarGabaritos(){
      for(let i=0;i<Questoes.length;i++){ mostrarGabarito(i); }
    }
    function resetQuestoes(){
      document.querySelectorAll('#listaQuestoes input[type="radio"]').forEach(r=> r.checked=false);
      document.querySelectorAll('#listaQuestoes input[type="text"]').forEach(t=> t.value='');
      document.querySelectorAll('.feedback').forEach(f=> f.textContent='');
      document.querySelectorAll('.answer').forEach(a=> {a.textContent=''; a.style.display='none';});
    }

    // Inicialização
    montarTabela();
    desenharGrade();
    montarQuestoes();
  </script>
</body>
</html>
